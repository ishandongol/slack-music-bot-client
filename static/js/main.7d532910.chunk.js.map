{"version":3,"sources":["config.ts","hooks/useSocket.tsx","components/Switch.tsx","components/Navbar.tsx","utils/axios.ts","components/Badge.tsx","components/Song.tsx","components/Spinner.tsx","components/VideoWrapper.tsx","components/Datepicker.tsx","components/Playlist.tsx","api/index.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["config","baseUrl","process","webSocketUrl","appName","defaultLatencyAndTolerance","latency","tolerance","defaultContext","socketConnected","socketId","isSyncMode","isHost","setIsSyncMode","Error","latencyAndTolerance","setLatencyAndTolerance","SocketContext","createContext","SocketProvider","children","value","url","socketRef","useRef","emitterRef","EventEmitter","useState","setSocketId","setSocketConnected","setIsHost","useEffect","socket","WebSocket","current","onopen","onclose","onmessage","e","JSON","parse","data","message","event_type","emit","console","log","close","removeAllListeners","useProvideSocket","Provider","useSocket","useContext","Switch","className","id","rest","type","htmlFor","Navbar","expanded","setExpanded","send","href","onClick","preventDefault","aria-expanded","data-bs-toggle","data-bs-target","aria-controls","aria-label","aria-current","undefined","toFixed","min","max","style","width","step","onChange","target","parseFloat","checked","AxiosError","status","details","axiosError","statusCode","Object","setPrototypeOf","prototype","this","axiosInstance","axios","create","baseURL","interceptors","response","use","error","request","asyncFunction","a","Badge","title","SongItem","song","isCurrent","playing","progress","isNextSong","duration","cursor","src","thumbnail_url","alt","description","height","role","aria-valuenow","aria-valuemin","aria-valuemax","Spinner","VideoWrapper","DatePicker","startDate","endDate","startDateId","endDateId","onDatesChange","focused","setFocused","displayFormat","isDayBlocked","day","isAfter","moment","isOutsideRange","focusedInput","onFocusChange","Playlist","playlist","setPlayList","setPlaying","setError","loading","setLoading","nextSameSong","setNextSameSong","startOf","endOf","startDateAndEndDate","setStartDateAndEndDate","playerRef","syncUpdate","setSyncUpdate","debouncedSeekRef","sendSeekMessage","videoReady","setVideoReady","currentSongPlayingInfo","setCurrentSongPlayingInfo","_id","$oid","user","index","currentSong","setCurrentSong","appendToPlaylist","useCallback","newItem","canControl","syncUpdateNow","seekNum","isPlaying","internalPlayer","getInternalPlayer","seekTo","playVideo","pauseVideo","err","handlePlayPause","video_id","video_index","seek","currentSongId","vidIndex","parseInt","length","copyDuration","nextSongId","currentInfo","playedSeconds","handleSeek","currentSongInfo","stringify","difference","Math","abs","player","currentVideoId","pendingUpdate","ready","getSocket","sendPlayPauseMessage","seconds","debounce","maxWait","leading","trailing","notifyDateChange","unix","syncMusic","emitter","on","removeListener","handleHostDateChange","start_date","end_date","onNewSong","json","fetchPlaylist","params","method","round","zIndex","position","ref","controls","onReady","onStart","onPlay","onPause","pip","onSeek","onProgress","onDuration","onEnded","nextIndex","nextSong","wrapper","format","map","nextSongIndex","App","Helmet","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7d532910.chunk.js","sourcesContent":["const config = {\n  baseUrl: process.env.REACT_APP_BACKEND_URL,\n  webSocketUrl: process.env.REACT_APP_WS_URL,\n  appName: process.env.REACT_APP_NAME,\n};\n\nexport default config;\n","import React, {\n  useState,\n  useEffect,\n  useContext,\n  createContext,\n  useRef,\n} from \"react\";\nimport EventEmitter from \"events\";\n\ninterface LatencyAndTolerance {latency:number,tolerance:number}\ninterface SocketContextInterface {\n  socketRef?: React.MutableRefObject<WebSocket | undefined>;\n  emitterRef?: React.MutableRefObject<EventEmitter>;\n  socketId: string;\n  socketConnected: boolean;\n  isSyncMode: boolean;\n  latencyAndTolerance: LatencyAndTolerance;\n  setLatencyAndTolerance: React.Dispatch<React.SetStateAction<LatencyAndTolerance>>\n  isHost: boolean;\n  setIsSyncMode: React.Dispatch<React.SetStateAction<boolean>>\n}\nconst defaultLatencyAndTolerance:LatencyAndTolerance = {latency:0,tolerance:0.9}\nconst defaultContext: SocketContextInterface = {\n  socketConnected: false,\n  socketId: \"\",\n  isSyncMode: false,\n  isHost: false,\n  setIsSyncMode: () => {\n    throw new Error(\"NOt implemented\");\n  },\n  latencyAndTolerance: defaultLatencyAndTolerance,\n  setLatencyAndTolerance: () => {\n    throw new Error(\"NOt implemented\");\n  },\n};\n\nconst SocketContext = createContext<SocketContextInterface>(defaultContext);\n\nconst useProvideSocket = (url: string): SocketContextInterface => {\n  const socketRef = useRef<WebSocket>();\n  const emitterRef = useRef<EventEmitter>(new EventEmitter());\n  const [socketId, setSocketId] = useState<string>(\"\");\n  const [socketConnected, setSocketConnected] = useState<boolean>(false);\n  const [latencyAndTolerance, setLatencyAndTolerance] = useState<LatencyAndTolerance>(defaultLatencyAndTolerance);\n  const [isHost, setIsHost] = useState<boolean>(false);\n  const [isSyncMode, setIsSyncMode] = useState<boolean>(false);\n  useEffect(() => {\n    const socket = new WebSocket(url);\n    socketRef.current = socket;\n    if (socket) {\n      socket.onopen = function () {\n        setSocketConnected(true);\n      };\n      socket.onclose = function () {\n        setSocketId(\"\");\n        setSocketConnected(false);\n      };\n      socket.onmessage = function (e) {\n        const { message, event_type } = JSON.parse(e.data);\n        if (event_type === \"welcome\") {\n          setSocketId(message);\n        }\n        if (event_type === \"host\") {\n          setIsHost(message === \"true\");\n        }\n        emitterRef.current?.emit(event_type, message);\n        console.log(\"Received: \" + e.data);\n      };\n    }\n  }, [url]);\n\n\n  useEffect(\n    () => () => {\n      if (socketRef.current) {\n        socketRef.current.close();\n      }\n      if (emitterRef.current) {\n        emitterRef.current.removeAllListeners();\n      }\n    },\n    []\n  );\n  return {\n    socketRef,\n    emitterRef,\n    socketConnected,\n    socketId,\n    isHost,\n    isSyncMode,\n    latencyAndTolerance,\n    setLatencyAndTolerance,\n    setIsSyncMode,\n  };\n};\n\ninterface SocketProviderProps {\n  children: React.ReactNode;\n  url?: string;\n}\nexport const SocketProvider = ({ children, url }: SocketProviderProps) => {\n  const value = useProvideSocket(url || \"\");\n  return (\n    <SocketContext.Provider value={value}>{children}</SocketContext.Provider>\n  );\n};\n\nexport const useSocket = () => {\n  return useContext(SocketContext);\n};","export const Switch = ({ className = '', children, id, ...rest }: Omit<React.DetailedHTMLProps<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>, 'type'>) => {\n    return (\n        <div className={`form-check form-switch ${className}`}>\n            <input type=\"checkbox\" className={`form-check-input`} {...rest} id={id} />\n            <label className=\"form-check-label text-light\" htmlFor={id}>{children}</label>\n        </div>\n    )\n}","import { useEffect,useState } from \"react\";\nimport config from \"../config\";\nimport { useSocket } from \"../hooks/useSocket\";\nimport { Switch } from \"./Switch\";\n\nexport const Navbar = () => {\n  const {\n    socketConnected,\n    socketId,\n    socketRef,\n    isSyncMode,\n    setIsSyncMode,\n    isHost,\n    latencyAndTolerance,\n    setLatencyAndTolerance,\n  } = useSocket();\n  const [expanded,setExpanded] = useState<boolean>(false)\n  const syncMode = ({\n    target: { checked },\n  }: React.ChangeEvent<HTMLInputElement>) => {\n    setIsSyncMode(checked);\n  };\n\n  useEffect(() => {\n    const socket = socketRef?.current;\n    if (socketConnected && socketId && socket) {\n      if (isSyncMode) {\n        socket.send(\"/join sync\");\n      } else {\n        socket.send(\"/leave sync\");\n      }\n    }\n  }, [isSyncMode, socketRef, socketConnected, socketId]);\n  return (\n    <nav className=\"navbar fixed-top navbar-expand-lg navbar-dark bg-dark\">\n      <div className=\"container-fluid\">\n        <a className=\"navbar-brand\" href=\"/\">\n          {config.appName}\n        </a>\n        <button\n          className=\"navbar-toggler\"\n          type=\"button\"\n          onClick={(e) =>{\n            e.preventDefault()\n            setExpanded(!expanded)\n          }}\n          aria-expanded={expanded}\n          data-bs-toggle=\"collapse\"\n          data-bs-target=\"#navbarText\"\n          aria-controls=\"navbarText\"\n          aria-label=\"Toggle navigation\"\n        >\n          <span className=\"navbar-toggler-icon\"></span>\n        </button>\n        <div className={`collapse navbar-collapse ${expanded ? \"show\":''}`} id=\"navbarText\">\n          <ul className=\"navbar-nav py-2 py-md-0\">\n            <li className=\"nav-item\">\n              {isSyncMode ? (\n                isHost ? (\n                  <span\n                    className=\"nav-link badge bg-success text-dark\"\n                    aria-current=\"page\"\n                  >\n                    Host\n                  </span>\n                ) : (\n                  <span\n                    className=\"nav-link badge bg-warning text-dark\"\n                    aria-current=\"page\"\n                  >\n                    Guest\n                  </span>\n                )\n              ) : undefined}\n            </li>\n          </ul>\n          <form className=\"d-flex ms-auto\">\n            {isSyncMode && !isHost && (\n              <>\n                <div className=\"input-group me-1\">\n                  <span className=\"input-group-text bg-dark text-light border-0\">\n                    Latency:{\" \"}\n                  </span>\n                  <span className=\"input-group-text bg-dark text-light border-0\">\n                    {latencyAndTolerance.latency.toFixed(2)}\n                  </span>\n                  <span className=\"input-group-text bg-dark text-light border-0\">\n                    Tolerance:{\" \"}\n                  </span>\n                  <input\n                    type=\"number\"\n                    min=\"0\"\n                    max=\"5\"\n                    style={{width:'75px'}}\n                    className=\"form-control bg-dark text-light border-0\"\n                    step=\"0.1\"\n                    value={latencyAndTolerance.tolerance}\n                    onChange={({ target: { value } }) => {\n                      setLatencyAndTolerance({\n                        ...latencyAndTolerance,\n                        tolerance: parseFloat(value || \"0\"),\n                      });\n                    }}\n                    aria-label=\"Dollar amount (with dot and two decimal places)\"\n                  />\n                </div>\n              </>\n            )}\n            <Switch\n              className=\"flex-shrink-0 align-self-center\"\n              onChange={syncMode}\n              checked={isSyncMode}\n            >\n              Sangai Sunam\n            </Switch>\n          </form>\n        </div>\n      </div>\n    </nav>\n  );\n};\n","import config from \"../config\";\nimport axios, { AxiosRequestConfig } from \"axios\";\n\nexport class AxiosError extends Error {\n  private statusCode: number | string;\n\n  private details: {\n    [id: string]: any;\n  };\n\n  private axiosError: any;\n\n  constructor(\n    status: number | string,\n    message: string,\n    details: any,\n    axiosError: any\n  ) {\n    super(message);\n    this.statusCode = status;\n    this.details = details;\n    this.axiosError = axiosError;\n    // only because we are extending a built in class\n    Object.setPrototypeOf(this, AxiosError.prototype);\n  }\n\n  toJSON() {\n    return {\n      message: this.message,\n      status: this.statusCode,\n      details: this.details,\n    };\n  }\n}\n\nexport const axiosInstance = axios.create({\n  baseURL: config.baseUrl,\n});\n\naxiosInstance.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response) {\n      // The request was made and the server responded with a status code\n      // that falls out of the range of 2xx\n      const axiosError = new AxiosError(\n        error.response.status,\n        error.response.data.message,\n        error.response.data,\n        error.response\n      );\n      throw axiosError;\n    } else if (error.request) {\n      // The request was made but no response was received\n      // `error.request` is an instance of XMLHttpRequest in the browser and an instance of\n      // http.ClientRequest in node.js\n      const axiosError = new AxiosError(\n        500,\n        \"No response from server\",\n        {},\n        error.request\n      );\n      throw axiosError;\n    } else {\n      // Something happened in setting up the request that triggered an Error\n      const axiosError = new AxiosError(\n        500,\n        error.message,\n        { message: \"Setting error\" },\n        {}\n      );\n      throw axiosError;\n    }\n  }\n);\n\nexport const asyncFunction = async (config: AxiosRequestConfig) => {\n  const response = await axiosInstance.request(config);\n  return response.data;\n};\n","export interface BadgeProps {\n  title: string;\n  className?: string;\n}\nexport const Badge = ({ title, className = \"\" }: BadgeProps) => {\n  return <span className={`badge mt-1 me-2 ${className}`}>{title}</span>;\n};\n","import { Badge } from \"./Badge\";\n\nexport interface Song {\n  user: string;\n  _id: {\n    $oid: string;\n  };\n  thumbnail_url: string;\n  url: string;\n  title: string;\n  description: string;\n  status: \"pending\" | \"playing\" | \"played\";\n}\n\ninterface SongProps {\n  song: Song;\n  onClick: React.MouseEventHandler<HTMLLIElement>;\n  isCurrent: boolean;\n  playing: boolean;\n  progress: number;\n  isNextSong: boolean;\n  duration: number;\n  className?: string;\n}\nexport const SongItem = ({\n  song,\n  onClick,\n  isCurrent,\n  playing,\n  progress,\n  isNextSong,\n  duration,\n  className,\n}: SongProps) => (\n  <li\n    onClick={onClick}\n    className={`list-group-item p-0 text-white px-5 py-2 mb-2 ${\n      className || \"\"\n    }`}\n    style={{\n      cursor: \"pointer\",\n    }}\n  >\n    <div className=\" d-flex\">\n      <div className=\"flex-shrink-0 d-flex\" style={{ width: \"20%\" }}>\n        <div className=\"align-self-center\">\n          <img\n            src={song.thumbnail_url}\n            className=\"img-fluid\"\n            alt={song.title}\n          />\n        </div>\n      </div>\n      <div className=\"flex-grow-1 py-2 px-3\">\n        <p className=\"mb-1\">{song.title || song.url}</p>\n        <p className=\"text-muted\">{song.description}</p>\n        <div className=\"d-flex\">\n          {isCurrent && playing && (\n            <>\n              <Badge className=\"align-self-center bg-success\" title=\"Playing\" />\n              <Badge\n                className=\"align-self-center bg-light text-dark\"\n                title={`${progress} %`}\n              />\n            </>\n          )}\n          {isCurrent && !playing && (\n            <Badge className=\"align-self-center bg-danger\" title=\"Paused\" />\n          )}\n          {isNextSong && (\n            <>\n              <Badge\n                className=\"align-self-center bg-warning text-dark\"\n                title=\"Up Next\"\n              />\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n    {isCurrent && (\n      <div className=\"progress bg-dark mt-2\" style={{ height: \"4px\" }}>\n        <div\n          className=\"progress-bar bg-danger\"\n          role=\"progressbar\"\n          style={{ width: `${progress}%` }}\n          aria-valuenow={progress}\n          aria-valuemin={0}\n          aria-valuemax={duration}\n        />\n      </div>\n    )}\n  </li>\n);\n","export const Spinner = () => {\n  return (\n    <div className=\"spinner-border text-light\" role=\"status\">\n      <span className=\"visually-hidden\">Loading...</span>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const VideoWrapper = ({children}:{children?:React.ReactNode}) => (\n    <div className=\"video-player\">\n    {children}\n</div>)","import { DateRangePicker } from \"react-dates\";\nimport type { Moment } from \"moment\";\nimport { useState } from \"react\";\nimport type { FocusedInputShape } from \"react-dates\";\nimport moment from \"moment\";\n\nexport interface StartDateAndEndDate {\n  startDate: Moment | null;\n  endDate: Moment | null;\n}\ninterface DatePickerProps {\n  startDate: Moment | null;\n  endDate: Moment | null;\n  startDateId: string;\n  endDateId: string;\n  onDatesChange: ({ startDate, endDate }: StartDateAndEndDate) => void;\n}\nexport const DatePicker = ({\n  startDate,\n  endDate,\n  startDateId,\n  endDateId,\n  onDatesChange,\n}: DatePickerProps) => {\n  const [focused, setFocused] = useState<FocusedInputShape | null>(null);\n\n  return (\n    <DateRangePicker\n      startDate={startDate}\n      displayFormat=\"dddd, MMM D\"\n      isDayBlocked={(day) => day.isAfter(moment())}\n      startDateId={startDateId}\n      isOutsideRange={() => false}\n      endDate={endDate}\n      endDateId={endDateId}\n      onDatesChange={onDatesChange}\n      focusedInput={focused}\n      onFocusChange={setFocused}\n    />\n  );\n};\n","import { useState } from \"react\";\nimport { useRef } from \"react\";\nimport { useCallback } from \"react\";\nimport { useEffect } from \"react\";\nimport ReactPlayer from \"react-player\";\nimport { getPlaylist } from \"../api\";\nimport { useSocket } from \"../hooks/useSocket\";\nimport { Song, SongItem } from \"./Song\";\nimport { Spinner } from \"./Spinner\";\nimport { VideoWrapper } from \"./VideoWrapper\";\nimport debounce from \"lodash/debounce\";\nimport { DatePicker, StartDateAndEndDate } from \"./Datepicker\";\nimport moment from \"moment\";\nimport { AxiosError } from \"../utils/axios\";\n\ninterface VideoPlayPauseEventPayload extends VideoSeekEventPayload {\n  playing: string;\n}\n\ninterface VideoSeekEventPayload {\n  video_id: string;\n  seek: string;\n  video_index: string;\n}\n\ninterface PendingEvent {\n  seek: number;\n  playing?: boolean;\n}\n\nexport const Playlist = () => {\n  const {\n    socketConnected,\n    socketId,\n    socketRef,\n    emitterRef,\n    isSyncMode,\n    isHost,\n    latencyAndTolerance,\n    setLatencyAndTolerance,\n  } = useSocket();\n\n  const [playlist, setPlayList] = useState<Song[]>([]);\n\n  const [playing, setPlaying] = useState<boolean>(false);\n\n  const [error, setError] = useState<AxiosError | undefined>();\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [nextSameSong, setNextSameSong] = useState<boolean>(false);\n\n  const [startDateAndEndDate, setStartDateAndEndDate] =\n    useState<StartDateAndEndDate>({\n      startDate: moment().startOf(\"day\"),\n      endDate: moment().endOf(\"day\"),\n    });\n\n  const playerRef = useRef<ReactPlayer>(null);\n\n  const [syncUpdate, setSyncUpdate] = useState<Record<string, PendingEvent>>(\n    {}\n  );\n\n  const debouncedSeekRef = useRef<{ sendSeekMessage: (seek: number) => void }>({\n    sendSeekMessage: () => {},\n  });\n\n  const [videoReady, setVideoReady] = useState<\n    Record<string, { ready: boolean }>\n  >({});\n\n  const [currentSongPlayingInfo, setCurrentSongPlayingInfo] = useState<\n    Record<string, { duration?: number; playedSeconds?: number }>\n  >({});\n\n  const [currentSong, setCurrentSong] = useState<Song & { index: number }>({\n    _id: {\n      $oid: \"\",\n    },\n    user: \"\",\n    url: \"\",\n    thumbnail_url: \"\",\n    status: \"pending\",\n    title: \"\",\n    description: \"\",\n    index: 0,\n  });\n\n  const appendToPlaylist = useCallback(\n    (newItem: Song) => {\n      setPlayList([...playlist, newItem]);\n    },\n    [playlist]\n  );\n\n  const canControl = isSyncMode ? (isHost ? true : false) : true;\n\n  const syncUpdateNow = useCallback((seekNum: number, isPlaying: boolean) => {\n    try {\n      const internalPlayer = playerRef?.current?.getInternalPlayer();\n      playerRef?.current?.seekTo(seekNum, \"seconds\");\n      if (internalPlayer) {\n        internalPlayer.seekTo(seekNum, true);\n        if (isPlaying) {\n          internalPlayer.playVideo();\n        } else {\n          internalPlayer.pauseVideo();\n        }\n        setPlaying(isPlaying);\n        setSyncUpdate({});\n      }\n    } catch (err) {\n      console.log(\"video try update error\", err);\n    }\n  }, []);\n\n  const handlePlayPause = useCallback(\n    (data: string) => {\n      const {\n        video_id,\n        video_index,\n        seek,\n        playing,\n      }: VideoPlayPauseEventPayload = JSON.parse(data);\n      const currentSongId = currentSong._id.$oid;\n      const seekNum = parseFloat(seek);\n      const vidIndex = parseInt(video_index, 10);\n      const isPlaying = playing === \"true\";\n      let song = currentSong;\n      if (currentSongId === video_id) {\n        setCurrentSong({ ...currentSong });\n      }\n      if (currentSongId !== video_id && playlist.length > vidIndex) {\n        // todo handle for video not found\n        song = { ...playlist[vidIndex], index: vidIndex };\n        setCurrentSong({ ...song });\n      }\n      setSyncUpdate({ [video_id]: { seek: seekNum, playing: isPlaying } });\n    },\n    [currentSong, playlist]\n  );\n  const copyDuration = (nextSongId: string) => {\n    const currentSongId = currentSong._id.$oid;\n    const currentInfo = currentSongPlayingInfo[currentSongId];\n    setCurrentSongPlayingInfo({\n      [nextSongId]: {\n        playedSeconds: 0,\n        duration: currentInfo.duration,\n      },\n    });\n  };\n  const handleSeek = useCallback(\n    (data: string) => {\n      const { video_id, seek, video_index }: VideoSeekEventPayload =\n        JSON.parse(data);\n      const currentSongInfo = currentSongPlayingInfo[video_id];\n      if (!currentSongInfo) {\n        return handlePlayPause(\n          JSON.stringify({\n            video_id,\n            video_index,\n            seek,\n            playing: true,\n          })\n        );\n      }\n      const seekNum = parseFloat(seek);\n      const difference = Math.abs(\n        (currentSongInfo?.playedSeconds || 0) - seekNum\n      );\n      const { tolerance } = latencyAndTolerance;\n      setLatencyAndTolerance({ ...latencyAndTolerance, latency: difference });\n      if (currentSongInfo && difference > tolerance) {\n        setSyncUpdate({ [video_id]: { seek: seekNum, playing: true } });\n      }\n    },\n    [\n      currentSongPlayingInfo,\n      latencyAndTolerance,\n      setLatencyAndTolerance,\n      handlePlayPause,\n    ]\n  );\n  useEffect(() => {\n    const player = playerRef.current?.getInternalPlayer();\n    if (nextSameSong && player) {\n      player.seekTo(0);\n      player.playVideo();\n      setPlaying(true);\n      setNextSameSong(false);\n    }\n  }, [nextSameSong, playerRef]);\n  useEffect(() => {\n    const currentVideoId = currentSong._id.$oid;\n    const pendingUpdate = syncUpdate[currentVideoId];\n    if (videoReady[currentVideoId]?.ready === true && pendingUpdate) {\n      syncUpdateNow(pendingUpdate.seek, pendingUpdate.playing || false);\n      const currentSongId = currentSong._id.$oid;\n      const currentInfo = currentSongPlayingInfo[currentSongId];\n      setCurrentSongPlayingInfo({\n        [currentSongId]: {\n          ...currentInfo,\n          playedSeconds: pendingUpdate.seek,\n        },\n      });\n    }\n  }, [\n    videoReady,\n    currentSong,\n    playlist,\n    syncUpdateNow,\n    syncUpdate,\n    currentSongPlayingInfo,\n  ]);\n\n  const getSocket = useCallback(() => socketRef?.current, [socketRef]);\n\n  const sendPlayPauseMessage = useCallback(\n    (isPlaying: boolean) => {\n      if (isHost && isSyncMode) {\n        const currentSongId = currentSong._id.$oid;\n        getSocket()?.send(\n          `/pp ${currentSongId} ${\n            currentSongPlayingInfo[currentSongId]?.playedSeconds || 0\n          } ${isPlaying} ${currentSong.index || 0}`\n        );\n      }\n    },\n    [currentSong, isSyncMode, isHost, getSocket, currentSongPlayingInfo]\n  );\n\n  const sendSeekMessage = useCallback(\n    (seconds: number) => {\n      if (isHost && isSyncMode) {\n        getSocket()?.send(\n          `/seek ${currentSong._id.$oid} ${seconds || 0} ${\n            currentSong.index || 0\n          }`\n        );\n      }\n    },\n    [isHost, isSyncMode, currentSong, getSocket]\n  );\n\n  useEffect(() => {\n    debouncedSeekRef.current = {\n      sendSeekMessage: debounce(sendSeekMessage, 3000, {\n        maxWait: 1500,\n        leading: false,\n        trailing: true,\n      }),\n    };\n  }, [sendSeekMessage]);\n  const notifyDateChange = useCallback(() => {\n    if (isHost && isSyncMode) {\n      const { startDate, endDate } = startDateAndEndDate;\n      getSocket()?.send(`/date ${startDate?.unix()} ${endDate?.unix()}`);\n    }\n  }, [startDateAndEndDate, isHost, isSyncMode, getSocket]);\n  const syncMusic = useCallback(() => {\n    sendPlayPauseMessage(playing);\n    notifyDateChange();\n  }, [sendPlayPauseMessage, playing, notifyDateChange]);\n\n  useEffect(() => {\n    const socket = socketRef?.current;\n    const emitter = emitterRef?.current;\n    if (\n      emitter &&\n      socketId &&\n      socketConnected &&\n      socket &&\n      isHost &&\n      isSyncMode\n    ) {\n      emitter.on(\"syncRoomJoined\", syncMusic);\n    }\n    return () => {\n      emitter?.removeListener(\"syncRoomJoined\", syncMusic);\n    };\n  }, [\n    socketRef,\n    emitterRef,\n    socketConnected,\n    socketId,\n    syncMusic,\n    playing,\n    isHost,\n    isSyncMode,\n  ]);\n  const handleHostDateChange = useCallback((data: string) => {\n    const { start_date, end_date } = JSON.parse(data);\n    setStartDateAndEndDate({\n      startDate: moment.unix(start_date),\n      endDate: moment.unix(end_date),\n    });\n  }, []);\n  useEffect(() => {\n    const socket = socketRef?.current;\n    const emitter = emitterRef?.current;\n    if (socket && socketConnected && socketId && emitter) {\n      emitter.on(\"playPause\", handlePlayPause);\n      emitter.on(\"seek\", handleSeek);\n      emitter.on(\"date\", handleHostDateChange);\n    }\n    return () => {\n      emitter?.removeListener(\"playPause\", handlePlayPause);\n      emitter?.removeListener(\"seek\", handleSeek);\n      emitter?.removeListener(\"date\", handleHostDateChange);\n    };\n  }, [\n    socketRef,\n    emitterRef,\n    socketId,\n    socketConnected,\n    handlePlayPause,\n    handleSeek,\n    handleHostDateChange,\n  ]);\n\n  useEffect(() => {\n    const socket = socketRef?.current;\n    const emitter = emitterRef?.current;\n    const onNewSong = (data: string) => {\n      const json: Song = JSON.parse(data);\n      appendToPlaylist(json);\n    };\n    if (socketConnected && socket && socketId && emitter) {\n      emitter.on(\"newSong\", onNewSong);\n    }\n    return () => {\n      emitter?.removeListener(\"newSong\", onNewSong);\n    };\n  }, [socketId, socketConnected, socketRef, emitterRef, appendToPlaylist]);\n\n  const fetchPlaylist = useCallback(async () => {\n    const { startDate, endDate } = startDateAndEndDate;\n    try {\n      setLoading(true);\n      const playlist = await getPlaylist({\n        startDate: startDate?.unix(),\n        endDate: endDate?.unix(),\n      });\n      setPlayList(playlist);\n    } catch (err) {\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n  }, [startDateAndEndDate]);\n\n  useEffect(() => {\n    fetchPlaylist();\n    notifyDateChange();\n  }, [fetchPlaylist, notifyDateChange]);\n\n  useEffect(() => {\n    if (playlist.length && !playing && !currentSong.url) {\n      setCurrentSong({ ...currentSong, ...playlist[0], index: 0 });\n    }\n  }, [playlist, playing, currentSong]);\n\n  const { playedSeconds, duration } = currentSongPlayingInfo[\n    currentSong._id.$oid\n  ] || { playedSeconds: 0, duration: 0 };\n\n  const progress =\n    playedSeconds && duration\n      ? Math.round((playedSeconds / duration) * 100)\n      : 0;\n  const { startDate, endDate } = startDateAndEndDate;\n\n  if (error) {\n    return (\n      <div className=\"max-height bg-dark d-flex align-items-center text-light justify-content-center w-full\">\n        {error.message || \"Oops! Something went wrong\"}\n      </div>\n    );\n  }\n  if (loading && !playlist.length) {\n    return (\n      <div className=\"max-height bg-dark d-flex align-items-center justify-content-center w-full\">\n        <Spinner />\n      </div>\n    );\n  }\n  return (\n    <div className=\"overflow-hidden d-flex bg-dark\">\n      <div className=\"flex-grow-1 col max-height\">\n        {!canControl && (\n          <div\n            style={{\n              width: \"100%\",\n              height: \"100%\",\n              zIndex: 1,\n              position: \"absolute\",\n            }}\n          />\n        )}\n        <ReactPlayer\n          ref={playerRef}\n          url={currentSong.url}\n          playing={playing}\n          controls={process.env.NODE_ENV === \"development\"}\n          onReady={() => {\n            setVideoReady({ [currentSong._id.$oid]: { ready: true } });\n          }}\n          onStart={() => {\n            sendPlayPauseMessage(true);\n            setPlaying(true);\n          }}\n          onPlay={() => {\n            sendPlayPauseMessage(true);\n            setPlaying(true);\n          }}\n          onPause={() => {\n            sendPlayPauseMessage(false);\n            setPlaying(false);\n          }}\n          pip\n          onSeek={(seconds) => {\n            if (canControl) {\n              sendSeekMessage(seconds);\n            }\n          }}\n          onProgress={({ playedSeconds }) => {\n            const currentSongId = currentSong._id.$oid;\n            const currentInfo = currentSongPlayingInfo[currentSongId];\n            setCurrentSongPlayingInfo({\n              [currentSongId]: { ...currentInfo, playedSeconds },\n            });\n            debouncedSeekRef.current.sendSeekMessage(playedSeconds);\n          }}\n          onDuration={(duration) => {\n            const currentSongId = currentSong._id.$oid;\n            const currentInfo = currentSongPlayingInfo[currentSongId];\n            setCurrentSongPlayingInfo({\n              [currentSongId]: {\n                ...currentInfo,\n                duration,\n              },\n            });\n          }}\n          onEnded={() => {\n            if (playlist.length) {\n              const nextIndex = currentSong.index + 1;\n              const nextSong =\n                nextIndex === playlist.length\n                  ? { ...playlist[0], index: 0 }\n                  : { ...playlist[nextIndex], index: nextIndex };\n              setCurrentSong(nextSong);\n              if (currentSong.url === nextSong.url) {\n                copyDuration(nextSong._id.$oid);\n                setNextSameSong(true);\n              }\n            }\n          }}\n          width={\"100%\"}\n          wrapper={VideoWrapper}\n        />\n      </div>\n      <div className=\"flex-shrink-0 col-sm-4 max-height\">\n        {canControl ? (\n          <DatePicker\n            startDate={startDate}\n            startDateId=\"startDate\"\n            endDate={endDate}\n            endDateId=\"endDate\"\n            onDatesChange={({ startDate, endDate }) => {\n              setStartDateAndEndDate({\n                startDate: startDate?.startOf(\"day\") || null,\n                endDate: endDate?.endOf(\"day\") || null,\n              });\n            }}\n          />\n        ) : (\n          <div className=\"text-light p-4 text-center\">\n            {moment(startDate).format(\"dddd, MMM D\")}\n            <span className=\"px-4\">to</span>\n            {moment(endDate).format(\"dddd, MMM D\")}\n          </div>\n        )}\n        {loading && (\n          <div\n            className=\"d-flex align-items-center justify-content-center p-2\"\n            style={{ width: \"100%\" }}\n          >\n            <Spinner />\n          </div>\n        )}\n        <ul className=\"list-group list-group-flush overflow-auto max-height-no-margin pb-5\">\n          {playlist.map((song, index) => {\n            const isCurrent = currentSong._id?.$oid === song._id?.$oid;\n            const nextSong = currentSong.index + 1;\n            const nextSongIndex = nextSong === playlist.length ? 0 : nextSong;\n            return (\n              <SongItem\n                className={`${isCurrent ? \"bg-black\" : \"bg-dark\"}`}\n                key={song._id?.$oid}\n                onClick={(e) => {\n                  e.preventDefault();\n                  if (!isCurrent && canControl) {\n                    setCurrentSong({ ...song, index });\n                    setPlaying(true);\n                    if (currentSong.url === song.url) {\n                      copyDuration(song._id.$oid);\n                      setNextSameSong(true);\n                    }\n                  }\n                }}\n                song={song}\n                isCurrent={isCurrent}\n                playing={playing}\n                isNextSong={nextSongIndex === index}\n                duration={duration || 0}\n                progress={progress}\n              />\n            );\n          })}\n        </ul>\n      </div>\n    </div>\n  );\n};\n","import { asyncFunction } from \"../utils/axios\";\n\nexport const getPlaylist = (params: { startDate?: number; endDate?: number }) =>\n  asyncFunction({ method: \"GET\", url: \"/playlist\", params });\n","import { Navbar } from \"./components/Navbar\";\nimport { Playlist } from \"./components/Playlist\";\nimport {Helmet} from 'react-helmet';\nimport config from \"./config\";\n\nfunction App() {\n  return (\n    <>\n    <Helmet>\n      <title>{config.appName}</title>\n    </Helmet>\n    <Navbar/>\n    <Playlist />\n    </>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { SocketProvider } from \"./hooks/useSocket\";\nimport config from \"./config\";\nimport \"react-dates/lib/css/_datepicker.css\";\nimport \"./assets/sass/main.scss\";\nimport \"react-dates/initialize\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <SocketProvider url={config.webSocketUrl}>\n      <App />\n    </SocketProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}