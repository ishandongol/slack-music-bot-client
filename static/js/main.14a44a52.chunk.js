(this["webpackJsonpslack-music-bot-client"]=this["webpackJsonpslack-music-bot-client"]||[]).push([[0],{83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n.n(s),r=n(27),a=n.n(r),i=n(3),o=n(8),l=n.n(o),u=n(11),d=n(34),b=n(6),j=n(28),f=n.n(j),O=n(29),g=n(30),p=n(13),v=n(31),h=n(35),x=n(36),m={baseUrl:"https://47b6b590bd2b.ngrok.io",webSocketUrl:"wss://47b6b590bd2b.ngrok.io/ws"},k=n(32),w=n.n(k),N=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(e,s,c,r){var a;return Object(O.a)(this,n),(a=t.call(this,s)).statusCode=void 0,a.details=void 0,a.axiosError=void 0,a.statusCode=e,a.details=c,a.axiosError=r,Object.setPrototypeOf(Object(p.a)(a),n.prototype),a}return Object(g.a)(n,[{key:"serializeErrors",value:function(){return[{message:this.message,status:this.statusCode,details:this.details}]}}]),n}(Object(x.a)(Error)),y=w.a.create({baseURL:m.baseUrl});y.interceptors.response.use((function(e){return e}),(function(e){if(e.response)throw new N(e.response.status,e.response.data.message,e.response.data,e.response);if(e.request)throw new N(500,"No Response",{},e.request);throw new N(500,e.message,{message:"Setting error"},{})}));var S=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.request(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=n(33),E=n.n(C),P=n(0),R={socketConnected:!1,socketId:""},_=Object(s.createContext)(R),F=function(e){var t=e.children,n=function(e){var t=Object(s.useRef)(),n=Object(s.useRef)(new E.a),c=Object(s.useState)(""),r=Object(b.a)(c,2),a=r[0],i=r[1],o=Object(s.useState)(!1),l=Object(b.a)(o,2),u=l[0],d=l[1];return Object(s.useEffect)((function(){var s=new WebSocket(e);t.current=s,s&&(s.onopen=function(){d(!0)},s.onclose=function(){i(""),d(!1)},s.onmessage=function(e){var t,s=JSON.parse(e.data),c=s.message,r=s.event_type;"welcome"===r&&i(c),null===(t=n.current)||void 0===t||t.emit(r,c),console.log("Received: "+e.data)})}),[e]),Object(s.useEffect)((function(){return function(){t.current&&t.current.close(),n.current&&n.current.removeAllListeners()}}),[]),{socketRef:t,emitterRef:n,socketConnected:u,socketId:a}}(e.url||"");return Object(P.jsx)(_.Provider,{value:n,children:t})},I=function(e){var t=e.title,n=e.className,s=void 0===n?"":n;return Object(P.jsx)("span",{className:"badge mt-1 me-2 ".concat(s),children:t})},L=function(e){var t=e.song,n=e.onClick,s=e.isCurrent,c=e.playing,r=e.progress,a=e.isNextSong,i=e.duration,o=e.className;return Object(P.jsxs)("li",{onClick:n,className:"list-group-item p-0 text-white px-5 py-2 mb-2 ".concat(o||""),style:{cursor:"pointer"},children:[Object(P.jsxs)("div",{className:" d-flex",children:[Object(P.jsx)("div",{className:"flex-shrink-0 d-flex",style:{width:"20%"},children:Object(P.jsx)("div",{className:"align-self-center",children:Object(P.jsx)("img",{src:t.thumbnail_url,className:"img-fluid",alt:t.title})})}),Object(P.jsxs)("div",{className:"flex-grow-1 py-2 px-3",children:[Object(P.jsx)("p",{className:"mb-1",children:t.title||t.url}),Object(P.jsx)("p",{className:"text-muted",children:t.description}),Object(P.jsxs)("div",{className:"d-flex",children:[s&&c&&Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(I,{className:"align-self-center bg-success",title:"Playing"}),Object(P.jsx)(I,{className:"align-self-center bg-light text-dark",title:"".concat(r," %")})]}),s&&!c&&Object(P.jsx)(I,{className:"align-self-center bg-danger",title:"Paused"}),a&&Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(I,{className:"align-self-center bg-warning text-dark",title:"Up Next"})})]})]})]}),s&&Object(P.jsx)("div",{className:"progress bg-dark mt-2",style:{height:"4px"},children:Object(P.jsx)("div",{className:"progress-bar bg-danger",role:"progressbar",style:{width:"".concat(r,"%")},"aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":i})})]})},U=function(){var e=Object(s.useContext)(_),t=e.socketConnected,n=e.socketId,c=e.socketRef,r=e.emitterRef,a=Object(s.useState)([]),o=Object(b.a)(a,2),j=o[0],O=o[1],g=Object(s.useState)(!1),p=Object(b.a)(g,2),v=p[0],h=p[1],x=Object(s.useState)({_id:{$oid:""},user:"",url:"",thumbnail_url:"",status:"pending",title:"",description:"",index:0}),m=Object(b.a)(x,2),k=m[0],w=m[1],N=Object(s.useCallback)((function(e){O([].concat(Object(d.a)(j),[e]))}),[j]);Object(s.useEffect)((function(){var e=null===c||void 0===c?void 0:c.current,s=null===r||void 0===r?void 0:r.current,a=function(e){var t=JSON.parse(e);N(t)};return t&&e&&n&&s&&(console.log("all done"),s.on("newSong",a)),function(){console.log("Clear"),null===s||void 0===s||s.removeListener("newSong",a)}}),[n,t,c,r,N]),Object(s.useEffect)((function(){(function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S({method:"GET",url:"/playlist"});case 3:t=e.sent,O(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(s.useEffect)((function(){!j.length||v||k.url||w(Object(i.a)(Object(i.a)(Object(i.a)({},k),j[0]),{},{index:0}))}),[j,v,k]);var y=k.playedSeconds,C=k.duration,E=y&&C?Math.round(y/C*100):0;return Object(P.jsxs)("div",{className:"overflow-hidden d-flex bg-dark",children:[Object(P.jsx)("div",{className:"flex-grow-1 col",children:Object(P.jsx)(f.a,{url:k.url,playing:v,onStart:function(){h(!0)},onPlay:function(){h(!0)},onPause:function(){h(!1)},pip:!0,onProgress:function(e){var t=e.playedSeconds;w(Object(i.a)(Object(i.a)({},k),{},{playedSeconds:t}))},onDuration:function(e){w(Object(i.a)(Object(i.a)({},k),{},{duration:e}))},onEnded:function(){if(j.length){var e=k.index+1;e===j.length?w(Object(i.a)(Object(i.a)({},j[0]),{},{index:0})):w(Object(i.a)(Object(i.a)({},j[e]),{},{index:e}))}},width:"100%",height:"100vh"})}),Object(P.jsxs)("div",{className:"flex-shrink-0 col-sm-3 overflow-auto",style:{height:"100vh"},children:[Object(P.jsx)("h3",{className:"text-center p-4 text-white bg-black mb-1 sticky-top",children:"Innovate PLaylist"}),Object(P.jsx)("ul",{className:"list-group list-group-flush",children:j.map((function(e,t){var n,s,c,r=(null===(n=k._id)||void 0===n?void 0:n.$oid)===(null===(s=e._id)||void 0===s?void 0:s.$oid),a=k.index+1,o=a===j.length?0:a;return Object(P.jsx)(L,{className:"".concat(r?"bg-black":"bg-dark"),onClick:function(n){n.preventDefault(),r||(w(Object(i.a)(Object(i.a)({},e),{},{index:t})),h(!0))},song:e,isCurrent:r,playing:v,isNextSong:o===t,duration:C||0,progress:E},null===(c=e._id)||void 0===c?void 0:c.$oid)}))})]})]})};var J=function(){return Object(P.jsx)(U,{})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),r(e),a(e)}))};n(83);a.a.render(Object(P.jsx)(c.a.StrictMode,{children:Object(P.jsx)(F,{url:m.webSocketUrl,children:Object(P.jsx)(J,{})})}),document.getElementById("root")),$()}},[[84,1,2]]]);
//# sourceMappingURL=main.14a44a52.chunk.js.map