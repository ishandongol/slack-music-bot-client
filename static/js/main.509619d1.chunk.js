(this["webpackJsonpslack-music-bot-client"]=this["webpackJsonpslack-music-bot-client"]||[]).push([[0],{83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),r=n(27),a=n.n(r),i=n(3),o=n(8),l=n.n(o),u=n(11),d=n(34),b=n(6),j=n(28),f=n.n(j),O=n(29),v=n(30),g=n(13),p=n(31),h=n(35),x=n(36),m={baseUrl:"http://192.168.10.65:5000",webSocketUrl:Object({NODE_ENV:"production",PUBLIC_URL:"/slack-music-bot-client",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"http://192.168.10.65:5000"}).REACT_APP_WS_URL},k=n(32),N=n.n(k),S=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e,c,s,r){var a;return Object(O.a)(this,n),(a=t.call(this,c)).statusCode=void 0,a.details=void 0,a.axiosError=void 0,a.statusCode=e,a.details=s,a.axiosError=r,Object.setPrototypeOf(Object(g.a)(a),n.prototype),a}return Object(v.a)(n,[{key:"serializeErrors",value:function(){return[{message:this.message,status:this.statusCode,details:this.details}]}}]),n}(Object(x.a)(Error)),w=N.a.create({baseURL:m.baseUrl});w.interceptors.response.use((function(e){return e}),(function(e){if(e.response)throw new S(e.response.status,e.response.data.message,e.response.data,e.response);if(e.request)throw new S(500,"No Response",{},e.request);throw new S(500,e.message,{message:"Setting error"},{})}));var y=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.request(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=n(33),E=n.n(C),_=n(0),P={socketConnected:!1,socketId:""},R=Object(c.createContext)(P),T=function(e){var t=e.children,n=function(e){var t=Object(c.useRef)(),n=Object(c.useRef)(new E.a),s=Object(c.useState)(""),r=Object(b.a)(s,2),a=r[0],i=r[1],o=Object(c.useState)(!1),l=Object(b.a)(o,2),u=l[0],d=l[1];return Object(c.useEffect)((function(){var c=new WebSocket(e);t.current=c,c&&(c.onopen=function(){d(!0)},c.onclose=function(){i(""),d(!1)},c.onmessage=function(e){var t,c=JSON.parse(e.data),s=c.message,r=c.event_type;"welcome"===r&&i(s),null===(t=n.current)||void 0===t||t.emit(r,s),console.log("Received: "+e.data)})}),[e]),Object(c.useEffect)((function(){return function(){t.current&&t.current.close(),n.current&&n.current.removeAllListeners()}}),[]),{socketRef:t,emitterRef:n,socketConnected:u,socketId:a}}(e.url||"");return Object(_.jsx)(R.Provider,{value:n,children:t})},L=function(e){var t=e.title,n=e.className,c=void 0===n?"":n;return Object(_.jsx)("span",{className:"badge mt-1 me-2 ".concat(c),children:t})},U=function(e){var t=e.song,n=e.onClick,c=e.isCurrent,s=e.playing,r=e.progress,a=e.isNextSong,i=e.duration,o=e.className;return Object(_.jsxs)("li",{onClick:n,className:"list-group-item p-0 text-white px-5 py-2 mb-2 ".concat(o||""),style:{cursor:"pointer"},children:[Object(_.jsxs)("div",{className:" d-flex",children:[Object(_.jsx)("div",{className:"flex-shrink-0 d-flex",style:{width:"20%"},children:Object(_.jsx)("div",{className:"align-self-center",children:Object(_.jsx)("img",{src:t.thumbnail_url,className:"img-fluid",alt:t.title})})}),Object(_.jsxs)("div",{className:"flex-grow-1 py-2 px-3",children:[Object(_.jsx)("p",{className:"mb-1",children:t.title||t.url}),Object(_.jsx)("p",{className:"text-muted",children:t.description}),Object(_.jsxs)("div",{className:"d-flex",children:[c&&s&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(L,{className:"align-self-center bg-success",title:"Playing"}),Object(_.jsx)(L,{className:"align-self-center bg-light text-dark",title:"".concat(r," %")})]}),c&&!s&&Object(_.jsx)(L,{className:"align-self-center bg-danger",title:"Paused"}),a&&Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(L,{className:"align-self-center bg-warning text-dark",title:"Up Next"})})]})]})]}),c&&Object(_.jsx)("div",{className:"progress bg-dark mt-2",style:{height:"4px"},children:Object(_.jsx)("div",{className:"progress-bar bg-danger",role:"progressbar",style:{width:"".concat(r,"%")},"aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":i})})]})},A=function(){var e=Object(c.useContext)(R),t=e.socketConnected,n=e.socketId,s=e.socketRef,r=e.emitterRef,a=Object(c.useState)([]),o=Object(b.a)(a,2),j=o[0],O=o[1],v=Object(c.useState)(!1),g=Object(b.a)(v,2),p=g[0],h=g[1],x=Object(c.useState)({_id:{$oid:""},user:"",url:"",thumbnail_url:"",status:"pending",title:"",description:"",index:0}),m=Object(b.a)(x,2),k=m[0],N=m[1],S=Object(c.useCallback)((function(e){O([].concat(Object(d.a)(j),[e]))}),[j]);Object(c.useEffect)((function(){var e=null===s||void 0===s?void 0:s.current,c=null===r||void 0===r?void 0:r.current,a=function(e){var t=JSON.parse(e);S(t)};return t&&e&&n&&c&&(console.log("all done"),c.on("newSong",a)),function(){console.log("Clear"),null===c||void 0===c||c.removeListener("newSong",a)}}),[n,t,s,r,S]),Object(c.useEffect)((function(){(function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y({method:"GET",url:"/playlist"});case 3:t=e.sent,O(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(c.useEffect)((function(){!j.length||p||k.url||N(Object(i.a)(Object(i.a)(Object(i.a)({},k),j[0]),{},{index:0}))}),[j,p,k]);var w=k.playedSeconds,C=k.duration,E=w&&C?Math.round(w/C*100):0;return Object(_.jsxs)("div",{className:"overflow-hidden d-flex bg-dark",children:[Object(_.jsx)("div",{className:"flex-grow-1 col",children:Object(_.jsx)(f.a,{url:k.url,playing:p,onStart:function(){h(!0)},onPlay:function(){h(!0)},onPause:function(){h(!1)},pip:!0,onProgress:function(e){var t=e.playedSeconds;N(Object(i.a)(Object(i.a)({},k),{},{playedSeconds:t}))},onDuration:function(e){N(Object(i.a)(Object(i.a)({},k),{},{duration:e}))},onEnded:function(){if(j.length){var e=k.index+1;e===j.length?N(Object(i.a)(Object(i.a)({},j[0]),{},{index:0})):N(Object(i.a)(Object(i.a)({},j[e]),{},{index:e}))}},width:"100%",height:"100vh"})}),Object(_.jsxs)("div",{className:"flex-shrink-0 col-sm-3 overflow-auto",style:{height:"100vh"},children:[Object(_.jsx)("h3",{className:"text-center p-4 text-white bg-black mb-1 sticky-top",children:"Innovate PLaylist"}),Object(_.jsx)("ul",{className:"list-group list-group-flush",children:j.map((function(e,t){var n,c,s,r=(null===(n=k._id)||void 0===n?void 0:n.$oid)===(null===(c=e._id)||void 0===c?void 0:c.$oid),a=k.index+1,o=a===j.length?0:a;return Object(_.jsx)(U,{className:"".concat(r?"bg-black":"bg-dark"),onClick:function(n){n.preventDefault(),r||(N(Object(i.a)(Object(i.a)({},e),{},{index:t})),h(!0))},song:e,isCurrent:r,playing:p,isNextSong:o===t,duration:C||0,progress:E},null===(s=e._id)||void 0===s?void 0:s.$oid)}))})]})]})};var D=function(){return Object(_.jsx)(A,{})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),s(e),r(e),a(e)}))};n(83);a.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(T,{url:m.webSocketUrl,children:Object(_.jsx)(D,{})})}),document.getElementById("root")),F()}},[[84,1,2]]]);
//# sourceMappingURL=main.509619d1.chunk.js.map