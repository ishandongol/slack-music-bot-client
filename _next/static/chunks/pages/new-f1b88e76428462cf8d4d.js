(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[971],{6292:function(e,t,n){"use strict";n.d(t,{A:function(){return b},Q:function(){return j}});var r=n(266),i=n(8216),a=n(5997),s=n(4695),o=n(1077),c=n(268),l=n(2953),d=n(3207),u=n(2809),v=n(809),f=n.n(v),p=n(3637),h=n(9669),m=n.n(h);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var _=function(e){(0,o.Z)(n,e);var t=x(n);function n(e,r,a,o){var c;return(0,i.Z)(this,n),c=t.call(this,r),(0,u.Z)((0,s.Z)(c),"statusCode",void 0),(0,u.Z)((0,s.Z)(c),"details",void 0),(0,u.Z)((0,s.Z)(c),"axiosError",void 0),c.statusCode=e,c.details=a,c.axiosError=o,Object.setPrototypeOf((0,s.Z)(c),n.prototype),c}return(0,a.Z)(n,[{key:"toJSON",value:function(){return{message:this.message,status:this.statusCode,details:this.details}}}]),n}((0,d.Z)(Error)),y=m().create({baseURL:p.Z.apiUrl});y.interceptors.response.use((function(e){return e}),(function(e){if(e.response)throw new _(e.response.status,e.response.data.message,e.response.data,e.response);if(e.request)throw new _(500,"No response from server",{},e.request);throw new _(500,e.message,{message:"Setting error"},{})}));var g=function(){var e=(0,r.Z)(f().mark((function e(t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.request(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(e){return g({method:"GET",url:"/playlist",params:e})},j=function(e){return g({method:"GET",url:"/songs",params:e})}},8382:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});var r=n(5893),i=function(){return(0,r.jsx)("div",{className:"spinner-border text-light",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}},8416:function(e,t,n){"use strict";n.d(t,{U:function(){return s},G:function(){return o}});n(7294);var r=n(6028),i=n.n(r),a=n(5893),s=function(e){var t=e.children;return(0,a.jsx)("div",{className:i().video_player,children:t})},o=function(e){var t=e.children;return(0,a.jsx)("div",{className:i().video_player_classic,children:t})}},513:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var r=n(266),i=n(2809),a=n(1508),s=n(809),o=n.n(s),c=n(7294),l=n(2004),d=n(6292),u=n(9138),v=n(8382),f=n(8416),p=n(3279),h=n.n(p),m=n(381),x=n.n(m),_=n(4938),y=n(8178),g=n(7138),b=n.n(g),j=n(5893),N=function(e){var t=e.children,n=e.className,r=void 0===n?"":n;return(0,j.jsx)("p",{className:"".concat(b().page_title," ").concat(r),children:t})},k=n(6205),w=n.n(k),S=function(e){var t=e.children,n=e.className,r=void 0===n?"":n;return(0,j.jsx)("div",{className:"".concat(w().playlist," bg-secondary p-4 ").concat(r),children:t})},C=n(8947),O=n(7814),Z=n(7843),P=n.n(Z),E=function(e){var t=e.title,n=e.subTitle,r=e.image,i=e.onAddClick;return(0,j.jsxs)("div",{className:"card ".concat(P().card," "),children:[(0,j.jsx)("img",{src:r,className:"card-img-top ".concat(P().image),alt:t}),(0,j.jsxs)("div",{className:"card-body",children:[(0,j.jsx)("p",{className:"card-text ".concat(P().card_title," mb-2"),title:t,children:t}),(0,j.jsx)("p",{className:"card-text ".concat(P().card_subtitle," text-gray"),title:n,children:n}),i&&(0,j.jsx)("div",{className:"position-absolute",style:{right:"1rem",bottom:"1rem"},children:(0,j.jsx)("button",{className:"btn btn-link text-muted p-0",type:"button",onClick:i,children:(0,j.jsx)(O.G,{icon:(0,C.N)({prefix:"fas",iconName:"plus-circle"})})})})]})]})},$=function(e){var t=e.title,n=e.subTitle,r=e.image,i=e.onClick,a=e.isNext,s=e.isCurrent;return(0,j.jsxs)("div",{className:"card mb-3 ".concat(P().card," ").concat(P().horizontal," position-relative"),onClick:i,children:[a&&(0,j.jsx)("span",{className:"badge position-absolute bg-primary ".concat(P().badge),children:"Up Next"}),s&&(0,j.jsx)("span",{className:"badge position-absolute bg-success ".concat(P().badge),children:"Playing"}),(0,j.jsxs)("div",{className:"row g-0 ",children:[(0,j.jsx)("div",{className:"col-md-4 ",children:(0,j.jsx)("img",{src:r,className:"img-fluid rounded-start",alt:t})}),(0,j.jsx)("div",{className:"col-md-8",children:(0,j.jsxs)("div",{className:"card-body",children:[(0,j.jsx)("p",{className:"card-text ".concat(P().card_title," my-3"),children:t}),(0,j.jsx)("p",{className:"card-text ".concat(P().card_subtitle," text-gray"),children:n})]})})]})]})},D=n(303);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=function(){var e=(0,u.s)(),t=e.socketConnected,n=e.socketId,s=e.socketRef,p=e.emitterRef,m=e.isSyncMode,g=e.isHost,b=e.latencyAndTolerance,k=e.setLatencyAndTolerance,w=(0,c.useState)([]),C=w[0],O=w[1],Z=(0,c.useState)([]),P=Z[0],R=Z[1],J=(0,c.useState)(!1),L=J[0],A=J[1],I=(0,c.useState)(),M=(I[0],I[1]),V=(0,c.useState)(!1),G=V[0],U=V[1],z=(0,c.useState)(!1),q=z[0],B=z[1],F=(0,c.useState)(!1),W=F[0],H=F[1],Q=(0,c.useState)({startDate:x()().startOf("day"),endDate:x()().endOf("day")}),X=Q[0],Y=Q[1],K=(0,c.useRef)(null),ee=(0,c.useState)({}),te=ee[0],ne=ee[1],re=(0,c.useRef)({sendSeekMessage:function(){}}),ie=(0,c.useState)({}),ae=ie[0],se=ie[1],oe=(0,c.useState)({}),ce=oe[0],le=oe[1],de=(0,c.useState)({_id:{$oid:""},user:"",url:"",thumbnail_url:"",status:"pending",title:"",description:"",index:0}),ue=de[0],ve=de[1],fe=(0,c.useCallback)((function(e){O([].concat((0,a.Z)(C),[e]))}),[C]),pe=!m||!!g,he=(0,c.useCallback)((function(e,t){try{var n,r,i=null===K||void 0===K||null===(n=K.current)||void 0===n?void 0:n.getInternalPlayer();null===K||void 0===K||null===(r=K.current)||void 0===r||r.seekTo(e,"seconds"),i&&(i.seekTo(e,!0),t?i.playVideo():i.pauseVideo(),A(t),ne({}))}catch(a){console.log("video try update error",a)}}),[]),me=(0,c.useCallback)((function(e){var t=JSON.parse(e),n=t.video_id,r=t.video_index,a=t.seek,s=t.playing,o=ue._id.$oid,c=parseFloat(a),l=parseInt(r,10),d="true"===s,u=ue;o===n&&ve(T({},ue)),o!==n&&C.length>l&&(u=T(T({},C[l]),{},{index:l}),ve(T({},u))),ne((0,i.Z)({},n,{seek:c,playing:d}))}),[ue,C]),xe=function(e){var t=ue._id.$oid,n=ce[t];le((0,i.Z)({},e,{playedSeconds:0,duration:null===n||void 0===n?void 0:n.duration}))},_e=(0,c.useCallback)((function(e){var t=JSON.parse(e),n=t.video_id,r=t.seek,a=t.video_index,s=ce[n];if(!s)return me(JSON.stringify({video_id:n,video_index:a,seek:r,playing:!0}));var o=parseFloat(r),c=Math.abs(((null===s||void 0===s?void 0:s.playedSeconds)||0)-o),l=b.tolerance;k(T(T({},b),{},{latency:c})),s&&c>l&&ne((0,i.Z)({},n,{seek:o,playing:!0}))}),[ce,b,k,me]);(0,c.useEffect)((function(){var e,t=null===(e=K.current)||void 0===e?void 0:e.getInternalPlayer();W&&t&&(t.seekTo(0),t.playVideo(),A(!0),H(!1))}),[W,K]),(0,c.useEffect)((function(){var e,t=ue._id.$oid,n=te[t];if(!0===(null===(e=ae[t])||void 0===e?void 0:e.ready)&&n){he(n.seek,n.playing||!1);var r=ue._id.$oid,a=ce[r];le((0,i.Z)({},r,T(T({},a),{},{playedSeconds:n.seek})))}}),[ae,ue,C,he,te,ce]);var ye=(0,c.useCallback)((function(){return null===s||void 0===s?void 0:s.current}),[s]),ge=(0,c.useCallback)((function(e){if(g&&m){var t,n,r=ue._id.$oid;null===(t=ye())||void 0===t||t.send("/pp ".concat(r," ").concat((null===(n=ce[r])||void 0===n?void 0:n.playedSeconds)||0," ").concat(e," ").concat(ue.index||0))}}),[ue,m,g,ye,ce]),be=(0,c.useCallback)((function(e){var t;g&&m&&(null===(t=ye())||void 0===t||t.send("/seek ".concat(ue._id.$oid," ").concat(e||0," ").concat(ue.index||0)))}),[g,m,ue,ye]);(0,c.useEffect)((function(){re.current={sendSeekMessage:h()(be,3e3,{maxWait:1500,leading:!1,trailing:!0})}}),[be]);var je=(0,c.useCallback)((function(){if(g&&m){var e,t=X.startDate,n=X.endDate;null===(e=ye())||void 0===e||e.send("/date ".concat(null===t||void 0===t?void 0:t.unix()," ").concat(null===n||void 0===n?void 0:n.unix()))}}),[X,g,m,ye]),Ne=(0,c.useCallback)((function(){ge(L),je()}),[ge,L,je]);(0,c.useEffect)((function(){var e=null===s||void 0===s?void 0:s.current,r=null===p||void 0===p?void 0:p.current;return r&&n&&t&&e&&g&&m&&r.on("syncRoomJoined",Ne),function(){null===r||void 0===r||r.removeListener("syncRoomJoined",Ne)}}),[s,p,t,n,Ne,L,g,m]);var ke=(0,c.useCallback)((function(e){var t=JSON.parse(e),n=t.start_date,r=t.end_date;Y({startDate:x().unix(n),endDate:x().unix(r)})}),[]);(0,c.useEffect)((function(){var e=null===s||void 0===s?void 0:s.current,r=null===p||void 0===p?void 0:p.current;return e&&t&&n&&r&&(r.on("playPause",me),r.on("seek",_e),r.on("date",ke)),function(){null===r||void 0===r||r.removeListener("playPause",me),null===r||void 0===r||r.removeListener("seek",_e),null===r||void 0===r||r.removeListener("date",ke)}}),[s,p,n,t,me,_e,ke]),(0,c.useEffect)((function(){var e=null===s||void 0===s?void 0:s.current,r=null===p||void 0===p?void 0:p.current,i=function(e){var t=JSON.parse(e);fe(t)};return t&&e&&n&&r&&r.on("newSong",i),function(){null===r||void 0===r||r.removeListener("newSong",i)}}),[n,t,s,p,fe]);var we=(0,c.useCallback)((0,r.Z)(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=X.startDate,n=X.endDate,e.prev=1,U(!0),e.next=5,(0,d.A)({startDate:null===t||void 0===t?void 0:t.unix(),endDate:null===n||void 0===n?void 0:n.unix()});case 5:r=e.sent,O(r||[]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),M(e.t0);case 12:return e.prev=12,U(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])}))),[X]),Se=(0,c.useCallback)((0,r.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X.startDate,X.endDate,e.prev=1,B(!0),e.next=5,(0,d.Q)({});case 5:t=e.sent,R(t||[]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),M(e.t0);case 12:return e.prev=12,B(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])}))),[]);(0,c.useEffect)((function(){Se()}),[Se]),(0,c.useEffect)((function(){we(),je()}),[we,je]),(0,c.useEffect)((function(){!C.length||L||ue.url||ve(T(T(T({},ue),C[0]),{},{index:0}))}),[C,L,ue]);var Ce=ce[ue._id.$oid]||{playedSeconds:0,duration:0},Oe=Ce.playedSeconds,Ze=Ce.duration;Oe&&Ze&&Math.round(Oe/Ze*100),X.startDate,X.endDate;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(_.h,{}),(0,j.jsxs)(y.Z,{noScroll:!0,children:[(0,j.jsx)(D.L,{}),(0,j.jsx)("div",{className:"container-fluid",children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-sm-12 col-md-4 max-height d-flex flex-column",children:[(0,j.jsx)(N,{className:"text-light",children:"Playlist for today"}),G&&(0,j.jsx)("div",{className:"d-flex align-items-center justify-content-center p-2",style:{width:"100%"},children:(0,j.jsx)(v.$,{})}),C.length>0&&(0,j.jsx)(S,{className:"overflow-auto mb-3",children:null===C||void 0===C?void 0:C.map((function(e,t){var n,r,i,a=(null===(n=ue._id)||void 0===n?void 0:n.$oid)===(null===(r=e._id)||void 0===r?void 0:r.$oid),s=ue.index+1,o=s===C.length?0:s;return(0,j.jsx)($,{title:e.title,isCurrent:a,isNext:o===t,subTitle:e.description,image:e.thumbnail_url,onClick:function(){!a&&pe&&(ve(T(T({},e),{},{index:t})),A(!0),ue.url===e.url&&(xe(e._id.$oid),H(!0)))}},null===(i=e._id)||void 0===i?void 0:i.$oid)}))}),(0,j.jsxs)("div",{className:"flex-shrink-0 mt-auto",children:[!pe&&(0,j.jsx)("div",{style:{width:"100%",height:"100%",zIndex:1,position:"absolute"}}),(0,j.jsx)(l.Z,{ref:K,url:ue.url,playing:L,onReady:function(){se((0,i.Z)({},ue._id.$oid,{ready:!0}))},onStart:function(){ge(!0),A(!0)},onPlay:function(){ge(!0),A(!0)},onPause:function(){ge(!1),A(!1)},pip:!0,onSeek:function(e){pe&&be(e)},onProgress:function(e){var t=e.playedSeconds,n=ue._id.$oid,r=ce[n];le((0,i.Z)({},n,T(T({},r),{},{playedSeconds:t}))),re.current.sendSeekMessage(t)},onDuration:function(e){var t=ue._id.$oid,n=ce[t];le((0,i.Z)({},t,T(T({},n),{},{duration:e})))},onEnded:function(){if(C.length){var e=ue.index+1,t=e===C.length?T(T({},C[0]),{},{index:0}):T(T({},C[e]),{},{index:e});ve(t),ue.url===t.url&&(xe(t._id.$oid),H(!0))}},width:"100%",wrapper:f.U})]})]}),(0,j.jsxs)("div",{className:"col-sm-12 col-md-8",children:[(0,j.jsx)(N,{className:"text-light",children:"Recently Played"}),(0,j.jsxs)("div",{className:"container-fluid overflow-auto max-height-no-margin",children:[q&&(0,j.jsx)("div",{className:"d-flex align-items-center justify-content-center p-2",style:{width:"100%"},children:(0,j.jsx)(v.$,{})}),(0,j.jsx)("div",{className:"row",children:P.map((function(e){return(0,j.jsx)("div",{className:"col-md-3",children:(0,j.jsx)(E,{onAddClick:C.find((function(t){return t._id.$oid===e._id.$oid}))?void 0:function(){return O((function(t){return[].concat((0,a.Z)(t),[e])}))},title:e.title,subTitle:e.description,image:e.thumbnail_url})},e._id.$oid)}))})]})]})]})})]})]})}},5832:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new",function(){return n(513)}])},6205:function(e){e.exports={playlist:"Playlist_playlist__11a1R"}},6028:function(e){e.exports={video_player:"VideoWrapper_video_player__19HDE",video_player_classic:"VideoWrapper_video_player_classic__2G6tb"}},7843:function(e){e.exports={card_subtitle:"Card_card_subtitle__3vJIC",card_title:"Card_card_title__3BwYT",image:"Card_image__1-dhp",card:"Card_card__Vk01v",horizontal:"Card_horizontal__2cD_h",badge:"Card_badge__462_k"}},7138:function(e){e.exports={page_title:"PageTitle_page_title__1irN8"}}},function(e){e.O(0,[774,885,30,954,83,888,179],(function(){return t=5832,e(e.s=t);var t}));var t=e.O();_N_E=t}]);