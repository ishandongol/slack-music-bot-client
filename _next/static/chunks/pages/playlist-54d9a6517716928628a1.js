(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[580],{6292:function(e,t,n){"use strict";n.d(t,{A:function(){return j},Q:function(){return O}});var r=n(266),a=n(8216),s=n(5997),i=n(4695),o=n(1077),c=n(268),l=n(2953),d=n(3207),u=n(2809),f=n(809),p=n.n(f),v=n(3637),g=n(9669),h=n.n(g);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var x=function(e){(0,o.Z)(n,e);var t=m(n);function n(e,r,s,o){var c;return(0,a.Z)(this,n),c=t.call(this,r),(0,u.Z)((0,i.Z)(c),"statusCode",void 0),(0,u.Z)((0,i.Z)(c),"details",void 0),(0,u.Z)((0,i.Z)(c),"axiosError",void 0),c.statusCode=e,c.details=s,c.axiosError=o,Object.setPrototypeOf((0,i.Z)(c),n.prototype),c}return(0,s.Z)(n,[{key:"toJSON",value:function(){return{message:this.message,status:this.statusCode,details:this.details}}}]),n}((0,d.Z)(Error)),b=h().create({baseURL:v.Z.apiUrl});b.interceptors.response.use((function(e){return e}),(function(e){if(e.response)throw new x(e.response.status,e.response.data.message,e.response.data,e.response);if(e.request)throw new x(500,"No response from server",{},e.request);throw new x(500,e.message,{message:"Setting error"},{})}));var y=function(){var e=(0,r.Z)(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.request(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(e){return y({method:"GET",url:"/playlist",params:e})},O=function(e){return y({method:"GET",url:"/songs",params:e})}},2848:function(e,t,n){"use strict";n.d(t,{P:function(){return f}});var r=n(2809),a=n(219),s=n(3637),i=n(6384),o=n.n(i),c=n(5893),l=["size","className","alt"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(e){var t=e.size,n=void 0===t?"large":t,r=e.className,i=void 0===r?"":r,d=e.alt,f=(0,a.Z)(e,l);return(0,c.jsx)("img",u(u({},f),{},{src:"".concat(s.Z.baseUrl,"/images/logo.png"),className:"".concat(o()[n]||""," ").concat(i),alt:d||"Music Playground"}))}},4938:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(9008),a=n(3637),s=n(5893),i=function(){return(0,s.jsxs)(r.default,{children:[(0,s.jsx)("title",{children:"Music Playground"}),(0,s.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,s.jsx)("link",{rel:"icon",href:"".concat(a.Z.baseUrl,"/favicon.ico")})]})}},8382:function(e,t,n){"use strict";n.d(t,{$:function(){return a}});var r=n(5893),a=function(){return(0,r.jsx)("div",{className:"spinner-border text-light",role:"status",children:(0,r.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}},8416:function(e,t,n){"use strict";n.d(t,{U:function(){return i},G:function(){return o}});n(7294);var r=n(6028),a=n.n(r),s=n(5893),i=function(e){var t=e.children;return(0,s.jsx)("div",{className:a().video_player,children:t})},o=function(e){var t=e.children;return(0,s.jsx)("div",{className:a().video_player_classic,children:t})}},3632:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var r=n(266),a=n(2809),s=n(1508),i=n(809),o=n.n(i),c=n(7294),l=n(2004),d=n(6292),u=n(9138),f=n(5893),p=function(e){var t=e.title,n=e.className,r=void 0===n?"":n;return(0,f.jsx)("span",{className:"badge mt-1 me-2 ".concat(r),children:t})},v=function(e){var t=e.song,n=e.onClick,r=e.isCurrent,a=e.playing,s=e.progress,i=e.isNextSong,o=e.duration,c=e.className;return(0,f.jsxs)("li",{onClick:n,className:"list-group-item p-0 text-white px-3 pt-2 pb-3 mb-2 mx-3 rounded-3 ".concat(c||""),style:{cursor:"pointer"},children:[(0,f.jsxs)("div",{className:"d-flex",children:[(0,f.jsx)("div",{className:"flex-shrink-0 d-flex",style:{backgroundImage:"url(".concat(t.thumbnail_url,")"),backgroundRepeat:"no-repeat",height:"auto",width:"20%",backgroundPosition:"center",backgroundSize:"contain"}}),(0,f.jsxs)("div",{className:"flex-grow-1 py-2 px-3",children:[(0,f.jsx)("p",{className:"mb-1",children:t.title||t.url}),(0,f.jsx)("small",{children:t.description}),(0,f.jsxs)("div",{className:"d-flex",children:[r&&a&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(p,{className:"align-self-center bg-primary",title:"Playing"}),(0,f.jsx)(p,{className:"align-self-center bg-light text-dark",title:"".concat(s," %")})]}),r&&!a&&(0,f.jsx)(p,{className:"align-self-center bg-danger",title:"Paused"}),i&&(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(p,{className:"align-self-center bg-secondary text-dark",title:"Up Next"})})]})]})]}),r&&(0,f.jsx)("div",{className:"progress bg-dark mt-2",style:{height:"4px"},children:(0,f.jsx)("div",{className:"progress-bar bg-white",role:"progressbar",style:{width:"".concat(s,"%")},"aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":o})})]})},g=n(8382),h=n(8416),m=n(3279),x=n.n(m),b=n(6141),y=n(381),j=n.n(y),O=function(e){var t=e.startDate,n=e.endDate,r=e.startDateId,a=e.endDateId,s=e.onDatesChange,i=(0,c.useState)(null),o=i[0],l=i[1];return(0,f.jsx)(b.DateRangePicker,{startDate:t,displayFormat:"dddd, MMM D",isDayBlocked:function(e){return e.isAfter(j()())},startDateId:r,isOutsideRange:function(){return!1},endDate:n,endDateId:a,onDatesChange:s,focusedInput:o,onFocusChange:l})},k=n(3637),N=n(219),w=["className","children","id"];function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t=e.className,n=void 0===t?"":t,r=e.children,a=e.id,s=(0,N.Z)(e,w);return(0,f.jsxs)("div",{className:"form-check form-switch ".concat(n),children:[(0,f.jsx)("input",_(_({type:"checkbox",className:"form-check-input"},s),{},{id:a})),(0,f.jsx)("label",{className:"form-check-label text-light",htmlFor:a,children:r})]})},S=n(1664),Z=n(2848);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(){var e=(0,u.s)(),t=e.socketConnected,n=e.socketId,r=e.socketRef,a=e.isSyncMode,s=e.setIsSyncMode,i=e.isHost,o=e.latencyAndTolerance,l=e.setLatencyAndTolerance,d=(0,c.useState)(!1),p=d[0],v=d[1];return(0,c.useEffect)((function(){var e=null===r||void 0===r?void 0:r.current;t&&n&&e&&(a?e.send("/join sync"):e.send("/leave sync"))}),[a,r,t,n]),(0,f.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:(0,f.jsxs)("div",{className:"container-fluid",children:[(0,f.jsx)(S.default,{href:"/",children:(0,f.jsx)("a",{className:"navbar-brand",children:(0,f.jsx)(Z.P,{size:"small",alt:k.Z.appName})})}),(0,f.jsx)("button",{className:"navbar-toggler",type:"button",onClick:function(e){e.preventDefault(),v(!p)},"aria-expanded":p,"data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-label":"Toggle navigation",children:(0,f.jsx)("span",{className:"navbar-toggler-icon"})}),(0,f.jsxs)("div",{className:"collapse navbar-collapse ".concat(p?"show":""),id:"navbarText",children:[(0,f.jsx)("ul",{className:"navbar-nav py-2 py-md-0",children:(0,f.jsx)("li",{className:"nav-item",children:a?i?(0,f.jsx)("span",{className:"nav-link badge bg-primary text-light","aria-current":"page",children:"Host"}):(0,f.jsx)("span",{className:"nav-link badge bg-secondary text-light","aria-current":"page",children:"Guest"}):void 0})}),(0,f.jsxs)("form",{className:"d-flex ms-auto",children:[a&&!i&&(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"input-group me-1",children:[(0,f.jsxs)("span",{className:"input-group-text bg-dark text-light border-0",children:["Latency:"," "]}),(0,f.jsx)("span",{className:"input-group-text bg-dark text-light border-0",children:o.latency.toFixed(2)}),(0,f.jsxs)("span",{className:"input-group-text bg-dark text-light border-0",children:["Tolerance:"," "]}),(0,f.jsx)("input",{type:"number",min:"0",max:"5",style:{width:"75px"},className:"form-control bg-dark text-light border-0",step:"0.1",value:o.tolerance,onChange:function(e){var t=e.target.value;l(E(E({},o),{},{tolerance:parseFloat(t||"0")}))},"aria-label":"Dollar amount (with dot and two decimal places)"})]})}),(0,f.jsx)(P,{className:"flex-shrink-0 align-self-center",onChange:function(e){var t=e.target.checked;s(t)},checked:a,children:"Sangai Sunam"})]})]})]})})},$=n(4938);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(){var e=(0,u.s)(),t=e.socketConnected,n=e.socketId,i=e.socketRef,p=e.emitterRef,m=e.isSyncMode,b=e.isHost,y=e.latencyAndTolerance,k=e.setLatencyAndTolerance,N=(0,c.useState)([]),w=N[0],D=N[1],_=(0,c.useState)(!1),P=_[0],S=_[1],Z=(0,c.useState)(),C=Z[0],E=Z[1],I=(0,c.useState)(!1),T=I[0],F=I[1],L=(0,c.useState)(!1),J=L[0],A=L[1],G=(0,c.useState)({startDate:j()().startOf("day"),endDate:j()().endOf("day")}),B=G[0],U=G[1],z=(0,c.useRef)(null),V=(0,c.useState)({}),H=V[0],q=V[1],W=(0,c.useRef)({sendSeekMessage:function(){}}),X=(0,c.useState)({}),Q=X[0],K=X[1],Y=(0,c.useState)({}),ee=Y[0],te=Y[1],ne=(0,c.useState)({_id:{$oid:""},user:"",url:"",thumbnail_url:"",status:"pending",title:"",description:"",index:0}),re=ne[0],ae=ne[1],se=(0,c.useCallback)((function(e){D([].concat((0,s.Z)(w),[e]))}),[w]),ie=!m||!!b,oe=(0,c.useCallback)((function(e,t){try{var n,r,a=null===z||void 0===z||null===(n=z.current)||void 0===n?void 0:n.getInternalPlayer();null===z||void 0===z||null===(r=z.current)||void 0===r||r.seekTo(e,"seconds"),a&&(a.seekTo(e,!0),t?a.playVideo():a.pauseVideo(),S(t),q({}))}catch(s){console.log("video try update error",s)}}),[]),ce=(0,c.useCallback)((function(e){var t=JSON.parse(e),n=t.video_id,r=t.video_index,s=t.seek,i=t.playing,o=re._id.$oid,c=parseFloat(s),l=parseInt(r,10),d="true"===i,u=re;o===n&&ae(R({},re)),o!==n&&w.length>l&&(u=R(R({},w[l]),{},{index:l}),ae(R({},u))),q((0,a.Z)({},n,{seek:c,playing:d}))}),[re,w]),le=function(e){var t=re._id.$oid,n=ee[t];te((0,a.Z)({},e,{playedSeconds:0,duration:n.duration}))},de=(0,c.useCallback)((function(e){var t=JSON.parse(e),n=t.video_id,r=t.seek,s=t.video_index,i=ee[n];if(!i)return ce(JSON.stringify({video_id:n,video_index:s,seek:r,playing:!0}));var o=parseFloat(r),c=Math.abs(((null===i||void 0===i?void 0:i.playedSeconds)||0)-o),l=y.tolerance;k(R(R({},y),{},{latency:c})),i&&c>l&&q((0,a.Z)({},n,{seek:o,playing:!0}))}),[ee,y,k,ce]);(0,c.useEffect)((function(){var e,t=null===(e=z.current)||void 0===e?void 0:e.getInternalPlayer();J&&t&&(t.seekTo(0),t.playVideo(),S(!0),A(!1))}),[J,z]),(0,c.useEffect)((function(){var e,t=re._id.$oid,n=H[t];if(!0===(null===(e=Q[t])||void 0===e?void 0:e.ready)&&n){oe(n.seek,n.playing||!1);var r=re._id.$oid,s=ee[r];te((0,a.Z)({},r,R(R({},s),{},{playedSeconds:n.seek})))}}),[Q,re,w,oe,H,ee]);var ue=(0,c.useCallback)((function(){return null===i||void 0===i?void 0:i.current}),[i]),fe=(0,c.useCallback)((function(e){if(b&&m){var t,n,r=re._id.$oid;null===(t=ue())||void 0===t||t.send("/pp ".concat(r," ").concat((null===(n=ee[r])||void 0===n?void 0:n.playedSeconds)||0," ").concat(e," ").concat(re.index||0))}}),[re,m,b,ue,ee]),pe=(0,c.useCallback)((function(e){var t;b&&m&&(null===(t=ue())||void 0===t||t.send("/seek ".concat(re._id.$oid," ").concat(e||0," ").concat(re.index||0)))}),[b,m,re,ue]);(0,c.useEffect)((function(){W.current={sendSeekMessage:x()(pe,3e3,{maxWait:1500,leading:!1,trailing:!0})}}),[pe]);var ve=(0,c.useCallback)((function(){if(b&&m){var e,t=B.startDate,n=B.endDate;null===(e=ue())||void 0===e||e.send("/date ".concat(null===t||void 0===t?void 0:t.unix()," ").concat(null===n||void 0===n?void 0:n.unix()))}}),[B,b,m,ue]),ge=(0,c.useCallback)((function(){fe(P),ve()}),[fe,P,ve]);(0,c.useEffect)((function(){var e=null===i||void 0===i?void 0:i.current,r=null===p||void 0===p?void 0:p.current;return r&&n&&t&&e&&b&&m&&r.on("syncRoomJoined",ge),function(){null===r||void 0===r||r.removeListener("syncRoomJoined",ge)}}),[i,p,t,n,ge,P,b,m]);var he=(0,c.useCallback)((function(e){var t=JSON.parse(e),n=t.start_date,r=t.end_date;U({startDate:j().unix(n),endDate:j().unix(r)})}),[]);(0,c.useEffect)((function(){var e=null===i||void 0===i?void 0:i.current,r=null===p||void 0===p?void 0:p.current;return e&&t&&n&&r&&(r.on("playPause",ce),r.on("seek",de),r.on("date",he)),function(){null===r||void 0===r||r.removeListener("playPause",ce),null===r||void 0===r||r.removeListener("seek",de),null===r||void 0===r||r.removeListener("date",he)}}),[i,p,n,t,ce,de,he]),(0,c.useEffect)((function(){var e=null===i||void 0===i?void 0:i.current,r=null===p||void 0===p?void 0:p.current,a=function(e){var t=JSON.parse(e);se(t)};return t&&e&&n&&r&&r.on("newSong",a),function(){null===r||void 0===r||r.removeListener("newSong",a)}}),[n,t,i,p,se]);var me=(0,c.useCallback)((0,r.Z)(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=B.startDate,n=B.endDate,e.prev=1,F(!0),e.next=5,(0,d.A)({startDate:null===t||void 0===t?void 0:t.unix(),endDate:null===n||void 0===n?void 0:n.unix()});case 5:r=e.sent,D(r||[]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),E(e.t0);case 12:return e.prev=12,F(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])}))),[B]);(0,c.useEffect)((function(){me(),ve()}),[me,ve]),(0,c.useEffect)((function(){!w.length||P||re.url||ae(R(R(R({},re),w[0]),{},{index:0}))}),[w,P,re]);var xe=ee[re._id.$oid]||{playedSeconds:0,duration:0},be=xe.playedSeconds,ye=xe.duration,je=be&&ye?Math.round(be/ye*100):0,Oe=B.startDate,ke=B.endDate;return C?(0,f.jsx)("div",{className:"max-height bg-dark d-flex align-items-center text-light justify-content-center w-full",children:C.message||"Oops! Something went wrong"}):T&&!w.length?(0,f.jsx)("div",{className:"max-height bg-dark d-flex align-items-center justify-content-center w-full",children:(0,f.jsx)(g.$,{})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)($.h,{}),(0,f.jsx)(M,{}),(0,f.jsxs)("div",{className:"overflow-hidden d-flex bg-dark",children:[(0,f.jsxs)("div",{className:"flex-grow-1 col max-height-no-margin",children:[!ie&&(0,f.jsx)("div",{style:{width:"100%",height:"100%",zIndex:1,position:"absolute"}}),(0,f.jsx)(l.Z,{ref:z,url:re.url,playing:P,controls:!1,onReady:function(){K((0,a.Z)({},re._id.$oid,{ready:!0}))},onStart:function(){fe(!0),S(!0)},onPlay:function(){fe(!0),S(!0)},onPause:function(){fe(!1),S(!1)},pip:!0,onSeek:function(e){ie&&pe(e)},onProgress:function(e){var t=e.playedSeconds,n=re._id.$oid,r=ee[n];te((0,a.Z)({},n,R(R({},r),{},{playedSeconds:t}))),W.current.sendSeekMessage(t)},onDuration:function(e){var t=re._id.$oid,n=ee[t];te((0,a.Z)({},t,R(R({},n),{},{duration:e})))},onEnded:function(){if(w.length){var e=re.index+1,t=e===w.length?R(R({},w[0]),{},{index:0}):R(R({},w[e]),{},{index:e});ae(t),re.url===t.url&&(le(t._id.$oid),A(!0))}},width:"100%",wrapper:h.G})]}),(0,f.jsxs)("div",{className:"flex-shrink-0 col-sm-4 max-height-no-margin",children:[ie?(0,f.jsx)(O,{startDate:Oe,startDateId:"startDate",endDate:ke,endDateId:"endDate",onDatesChange:function(e){var t=e.startDate,n=e.endDate;U({startDate:(null===t||void 0===t?void 0:t.startOf("day"))||null,endDate:(null===n||void 0===n?void 0:n.endOf("day"))||null})}}):(0,f.jsxs)("div",{className:"text-light p-4 text-center",children:[j()(Oe).format("dddd, MMM D"),(0,f.jsx)("span",{className:"px-4",children:"to"}),j()(ke).format("dddd, MMM D")]}),T&&(0,f.jsx)("div",{className:"d-flex align-items-center justify-content-center p-2",style:{width:"100%"},children:(0,f.jsx)(g.$,{})}),(0,f.jsx)("ul",{className:"list-group list-group-flush overflow-auto max-height-no-margin pb-5",children:null===w||void 0===w?void 0:w.map((function(e,t){var n,r,a,s=(null===(n=re._id)||void 0===n?void 0:n.$oid)===(null===(r=e._id)||void 0===r?void 0:r.$oid),i=re.index+1,o=i===w.length?0:i;return(0,f.jsx)(v,{className:"".concat(s?"bg-secondary":"bg-dark"),onClick:function(n){n.preventDefault(),!s&&ie&&(ae(R(R({},e),{},{index:t})),S(!0),re.url===e.url&&(le(e._id.$oid),A(!0)))},song:e,isCurrent:s,playing:P,isNextSong:o===t,duration:ye||0,progress:je},null===(a=e._id)||void 0===a?void 0:a.$oid)}))})]})]})]})}},5017:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/playlist",function(){return n(3632)}])},6384:function(e){e.exports={small:"BrandImage_small__3rwwu",large:"BrandImage_large__-1rBv"}},6028:function(e){e.exports={video_player:"VideoWrapper_video_player__19HDE",video_player_classic:"VideoWrapper_video_player_classic__2G6tb"}}},function(e){e.O(0,[774,885,954,47,888,179],(function(){return t=5017,e(e.s=t);var t}));var t=e.O();_N_E=t}]);